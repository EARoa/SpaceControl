<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Space Control ðŸš€</title>
  <style>
       body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 0;
      background: #ffffff;
      height: 100vh;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }

    .container {
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding: 16px;
      flex: 1;
    }

    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .button-container {
      padding: 16px;
      border-top: 1px solid #e5e5e5;
      background: #ffffff;
    }

    .field-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-size: 12px;
      font-weight: 500;
      color: #333333;
      line-height: 16px;
    }

    input {
      height: 32px;
      padding: 0 8px;
      border: 1px solid #e5e5e5;
      border-radius: 6px;
      font-size: 12px;
      background: #ffffff;
      color: #333333;
      outline: none;
      transition: border-color 0.2s;
      width: 100%;
      box-sizing: border-box;
    }

    input:focus {
      border-color: #18a0fb;
      box-shadow: 0 0 0 1px #18a0fb;
    }

    .resize-button {
      height: 36px;
      background: #18a0fb;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
      width: 100%;
      box-sizing: border-box;
    }

    .resize-button:hover {
      background: #0c7ce6;
    }

    .resize-button:active {
      background: #0969da;
    }

    .resize-button:disabled {
      background: #e5e5e5;
      color: #999999;
      cursor: not-allowed;
    }

    .error {
      font-size: 11px;
      color: #f24822;
      margin-top: 4px;
    }

    .calculation-preview {
      background: #f7f7f7;
      border-radius: 6px;
      padding: 12px;
      font-size: 11px;
      color: #666666;
      margin-top: 8px;
      display: none;
    }

    .calculation-preview.show {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="field-group">
      <label for="targetWidth">How wide is your target?</label>
      <input type="number" id="targetWidth" placeholder="e.g. 800" min="1">
    </div>

    <div class="field-group">
      <label for="padding">Padding between items (px)</label>
      <input type="number" id="padding" placeholder="e.g. 20" min="0" value="0">
    </div>

    <div class="field-group">
      <label for="itemCount">How many items are you planning to resize?</label>
      <input type="number" id="itemCount" placeholder="e.g. 3" min="1">
    </div>

    <div class="calculation-preview" id="preview">
      <div id="previewText"></div>
    </div>
    <div class="error" id="errorMessage"></div>
    <button class="resize-button" id="resizeButton">Resize!</button>
  </div>

  <script>
    const targetWidthInput = document.getElementById('targetWidth');
    const itemCountInput = document.getElementById('itemCount');
    const paddingInput = document.getElementById('padding');
    const resizeButton = document.getElementById('resizeButton');
    const errorMessage = document.getElementById('errorMessage');
    const preview = document.getElementById('preview');
    const previewText = document.getElementById('previewText');

    function updatePreview() {
      const targetWidth = parseFloat(targetWidthInput.value) || 0;
      const itemCount = parseInt(itemCountInput.value) || 0;
      const padding = parseFloat(paddingInput.value) || 0;

      if (targetWidth > 0 && itemCount > 0) {
        const totalPadding = padding * (itemCount - 1);
        const availableWidth = targetWidth - totalPadding;
        const itemWidth = availableWidth / itemCount;

        if (itemWidth > 0) {
          previewText.innerHTML = `
            <strong>Stats for Nerds:</strong><br>
            Target: ${targetWidth}px - Padding: ${totalPadding}px = ${availableWidth}px<br>
            Item width: ${availableWidth}px Ã· ${itemCount} = ${itemWidth.toFixed(2)}px each
          `;
          preview.classList.add('show');
        } else {
          preview.classList.remove('show');
        }
      } else {
        preview.classList.remove('show');
      }
    }

    function validateInputs() {
      const targetWidth = parseFloat(targetWidthInput.value);
      const itemCount = parseInt(itemCountInput.value);
      const padding = parseFloat(paddingInput.value) || 0;

      errorMessage.textContent = '';

      if (!targetWidth || targetWidth <= 0) {
        errorMessage.textContent = 'Please enter a valid target width';
        return false;
      }

      if (!itemCount || itemCount <= 0) {
        errorMessage.textContent = 'Please enter a valid number of items';
        return false;
      }

      const totalPadding = padding * (itemCount - 1);
      if (totalPadding >= targetWidth) {
        errorMessage.textContent = 'Total padding exceeds target width';
        return false;
      }

      return true;
    }

    [targetWidthInput, itemCountInput, paddingInput].forEach(input => {
      input.addEventListener('input', updatePreview);
    });

    resizeButton.addEventListener('click', () => {
      if (!validateInputs()) return;

      const targetWidth = parseFloat(targetWidthInput.value);
      const itemCount = parseInt(itemCountInput.value);
      const padding = parseFloat(paddingInput.value) || 0;

      parent.postMessage({
        pluginMessage: {
          type: 'resize-elements',
          data: {
            targetWidth,
            itemCount,
            padding
          }
        }
      }, '*');
    });

    window.onmessage = (event) => {
      const { type, message } = event.data.pluginMessage || {};
      
      if (type === 'error') {
        errorMessage.textContent = message;
      } else if (type === 'success') {
        errorMessage.textContent = '';
      }
    };
  </script>
</body>
</html>